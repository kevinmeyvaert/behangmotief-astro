---
import BaseLightbox, { type LightboxImage } from './BaseLightbox.astro';

interface Props {
  alt: string;
}

const { alt } = Astro.props;
---

<div class="album-lightbox">
  <BaseLightbox
    images={[]}
    enableNavigation={true}
    enableUrlParams={true}
    triggerSelector="[data-album-image-trigger]"
    className="album"
  />
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const triggers = document.querySelectorAll('[data-album-image-trigger]');
    const images = Array.from(triggers).map((trigger) => ({
      id: trigger.getAttribute('data-image-id') || '',
      url: trigger.getAttribute('data-full-image') || '',
      alt: trigger.getAttribute('data-alt') || '',
      blurhash: trigger.getAttribute('data-blurhash') || undefined,
      width: parseInt(trigger.getAttribute('data-width') || '0', 10) || undefined,
      height: parseInt(trigger.getAttribute('data-height') || '0', 10) || undefined,
    }));

    const container = document.querySelector('.album-lightbox [data-lightbox-container]');
    if (container) {
      container.setAttribute('data-images', JSON.stringify(images));
    }
  });
</script>